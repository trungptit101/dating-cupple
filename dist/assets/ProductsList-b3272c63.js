import{d as P,r as g,a as E,c as F,b as n,g as e,f as l,i as p,s as R,e as U,h as L,t as C,v as M,F as z,E as y,j as X,u as B,p as N,k as j,_ as D,m as A,n as q,q as G,P as H}from"./index-6d8ceaa0.js";import{E as O,a as W,_ as J}from"./el-table-column-bf8e626a.js";import"./el-col-358a2cfc.js";import{S as x}from"./http-7590b1ae.js";import{f as K}from"./string-5c0d6496.js";import{E as Q}from"./EImg-afc854a5.js";import{_ as Y}from"./CBarcode.vue_vue_type_script_setup_true_lang-3bf86942.js";import{C as Z,_ as I}from"./CModalConfirm-a9b6db9a.js";/* empty css                     */import{P as $}from"./ProductService-a40b6bca.js";import{C as ee}from"./CPageContainer-bffd0214.js";import{C as te}from"./CModalImport-bbc89957.js";import{E as ae}from"./index-1e444a29.js";import"./index-1594f5df.js";import"./event-9519ab40.js";import"./validator-7169f7a8.js";import"./index-c8f47367.js";import"./flatten-76ec7d12.js";import"./datetime-419cfc94.js";import"./datetime-005f784b.js";import"./index-62461acb.js";const w=m=>(N("data-v-f8a7cd9e"),m=m(),j(),m),oe={class:"tbl"},ne=["title"],se=["title"],le={class:"d-flex align-items-center justify-center"},ie=["onClick"],re=w(()=>n("i",{class:"icon-Trash"},null,-1)),ce=[re],de=["onClick"],pe=w(()=>n("i",{class:"icon-Edit"},null,-1)),me=[pe],_e=["onClick"],ue=w(()=>n("i",{class:"icon-eye-2"},null,-1)),fe=[ue],he=P({__name:"ProductsTable",props:{items:{default:()=>[]}},emits:["refresh"],setup(m,{emit:k}){const v=m,_=g(null),o=B(),b=c=>{_.value.open({id:c.id,title:"Xoá sản phẩm",message:`Bạn có chắc chắn muốn xóa sản phẩm <b>${c.name}</b> không?`})},f=async c=>{try{const{code:h}=await $.delete(c);if(h===x)return y({message:"Xoá sản phẩm thành công",type:"success"}),k("refresh"),_.value.close()}catch(h){console.log(h)}},T=c=>{o.pushByPath(`/products/form/${c.id}`)},S=c=>{o.pushByPath(`/products/${c.id}`)};return(c,h)=>{const r=O,i=X,t=W;return E(),F(z,null,[n("div",oe,[e(t,{data:v.items,class:"tbl__table"},{default:l(()=>[e(r,{prop:"id",label:"ID",width:"100",align:"center"}),e(r,{prop:"image",label:"Ảnh",width:"90",align:"center"},{default:l(({row:a})=>[e(p(Q),{src:a.images[0],size:"60px",radius:"8px","object-fit":p(R).contain},null,8,["src","object-fit"])]),_:1}),e(r,{prop:"name",label:"Tên sản phẩm","min-width":"240",align:"left","header-align":"center"}),e(r,{prop:"barcode",label:"Mã vạch",width:"200",align:"center"},{default:l(({row:a})=>[a.barcode?(E(),U(p(Y),{key:0,value:a.barcode,id:a.id},null,8,["value","id"])):L("",!0)]),_:1}),e(r,{prop:"price",label:"Giá niêm yết",width:"165",align:"center"},{default:l(({row:a})=>[n("span",null,C(p(K)(a.price)||"-")+" "+C(a.priceUnit),1)]),_:1}),e(r,{prop:"brand",label:"Thương hiệu",width:"165",align:"center"},{default:l(({row:a})=>[n("span",{class:M(["tbl__item--created-by",{empty:!a.brand}]),title:a.brand},C(a.brand||"Đang cập nhật"),11,ne)]),_:1}),e(r,{prop:"createdBy",label:"Người tạo",width:"205",align:"center"},{default:l(({row:a})=>[n("span",{class:"tbl__item--created-by",title:a.createdByName},C(a.createdByName||"-"),9,se)]),_:1}),e(r,{prop:"createdAtStr",label:"Ngày tạo",width:"205",align:"center"}),e(r,{prop:"updatedAtStr",label:"Ngày cập nhật",width:"205",align:"center"}),e(r,{fixed:"right",prop:"action",label:"Hành động",width:"205",align:"center"},{default:l(({row:a})=>[n("div",le,[e(i,{content:"Xoá"},{default:l(()=>[n("div",{class:"tbl__action btn__action--red d-flex justify-center align-items-center",onClick:d=>b(a)},ce,8,ie)]),_:2},1024),e(i,{content:"Chỉnh sửa"},{default:l(()=>[n("div",{class:"tbl__action btn__action--blue d-flex justify-center align-items-center",onClick:d=>T(a)},me,8,de)]),_:2},1024),e(i,{content:"Xem chi tiết"},{default:l(()=>[n("div",{class:"tbl__action btn__action--yellow d-flex justify-center align-items-center",onClick:d=>S(a)},fe,8,_e)]),_:2},1024)])]),_:1})]),_:1},8,["data"])]),e(p(Z),{ref_key:"modalConfirmRef",ref:_,onConfirm:f},null,512)],64)}}});const ge=D(he,[["__scopeId","data-v-f8a7cd9e"]]),u=m=>(N("data-v-93a7ddd6"),m=m(),j(),m),ye={class:"product__content p-16 rounded-sm"},ve={class:"product__filter d-flex align-items-center justify-start flex-wrap"},be=u(()=>n("i",{class:"product__filter__item__icon icon-Search"},null,-1)),Ce=u(()=>n("i",{class:"icon-Search"},null,-1)),xe=u(()=>n("i",{class:"icon-Resset"},null,-1)),$e={class:"d-flex align-items-center justify-start mt-4 mb-32"},ke=u(()=>n("i",{class:"icon-add-3 mr-4"},null,-1)),Te=u(()=>n("span",null,"Thêm mới",-1)),Se=u(()=>n("i",{class:"icon-import mr-4"},null,-1)),Ee=u(()=>n("span",null,"Import",-1)),we=u(()=>n("i",{class:"icon-export-2 mr-4"},null,-1)),Ie=u(()=>n("span",null,"Export",-1)),Pe={class:"d-flex align-items-center justify-end mt-16"},Fe=P({__name:"ProductsList",setup(m){const k=B(),v=g([]),_=g(),o=g({page:1,pageSize:H,keyword:"",brand:"",createdFrom:"",createdTo:"",updatedFrom:"",updatedTo:""}),b=g(0),f=async()=>{try{const{code:i,data:t}=await $.getList(o.value);i===x&&i===x&&(v.value=t.items,b.value=t.totalElement)}catch{y({message:"Có lỗi xảy ra",type:"error"})}},T=async()=>{try{const i=await $.export(o.value);return q(i,"Danh sách sản phẩm")}catch(i){console.log(i),y({message:"Có lỗi xảy ra",type:"error"})}},S=()=>{_.value.open({template:"https://assets.icheck.vn/application/2023/app/3/8/3527ce664af73dd7b7ef6501933fa63e.xlsx"})},c=()=>{o.value.page=1,f()},h=async i=>{var t,a,d;try{(t=_.value)==null||t.changeLoading(!0);const s=new FormData;s.append("file",i[0],i[0].name);const{code:V}=await $.import(s);V===x?(y({message:"Import sản phẩm thành công",type:"success"}),(a=_.value)==null||a.close(),await r()):y({title:"Có lỗi xảy ra",message:"Vui lòng thử lại",type:"error"})}catch(s){console.log(s)}finally{(d=_.value)==null||d.changeLoading(!1)}},r=()=>{o.value={page:1,pageSize:o.value.pageSize,keyword:"",brand:"",createdFrom:null,createdTo:null,updatedFrom:null,updatedTo:null},f()};return A(async()=>{await f()}),(i,t)=>{const a=ae,d=G;return E(),F(z,null,[e(p(ee),{class:"product",title:"Danh sách sản phẩm"},{default:l(()=>[n("div",ye,[n("div",ve,[e(a,{class:"product__filter__item mr-8 mb-8",modelValue:o.value.keyword,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.keyword=s),placeholder:"Tên hoặc mã sản phẩm"},{prefix:l(()=>[be]),_:1},8,["modelValue"]),e(a,{class:"product__filter__item mr-8 mb-8",modelValue:o.value.brand,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.brand=s),placeholder:"Thương hiệu"},null,8,["modelValue"]),e(p(I),{class:"product__filter__item product__filter__item--daterange mr-8 mb-8",from:o.value.createdFrom,"onUpdate:from":t[2]||(t[2]=s=>o.value.createdFrom=s),to:o.value.createdTo,"onUpdate:to":t[3]||(t[3]=s=>o.value.createdTo=s),type:"daterange","range-separator":"~","start-placeholder":"Ngày tạo: Từ","end-placeholder":"Đến"},null,8,["from","to"]),e(p(I),{class:"product__filter__item product__filter__item--daterange mr-8 mb-8",from:o.value.updatedFrom,"onUpdate:from":t[4]||(t[4]=s=>o.value.updatedFrom=s),to:o.value.updatedTo,"onUpdate:to":t[5]||(t[5]=s=>o.value.updatedTo=s),type:"daterange","range-separator":"~","start-placeholder":"Ngày cập nhật: Từ","end-placeholder":"Đến"},null,8,["from","to"]),e(d,{type:"primary",class:"mb-8",onClick:c},{default:l(()=>[Ce]),_:1}),e(d,{class:"mb-8",onClick:r},{default:l(()=>[xe]),_:1})]),n("div",$e,[e(d,{type:"primary",onClick:t[6]||(t[6]=s=>p(k).pushByPath("/products/form"))},{default:l(()=>[ke,Te]),_:1}),e(d,{type:"info",onClick:S},{default:l(()=>[Se,Ee]),_:1}),e(d,{type:"info",onClick:T},{default:l(()=>[we,Ie]),_:1})]),e(ge,{items:v.value,onRefresh:f},null,8,["items"]),n("div",Pe,[e(p(J),{"current-page":o.value.page,"onUpdate:currentPage":t[7]||(t[7]=s=>o.value.page=s),"page-size":o.value.pageSize,"onUpdate:pageSize":t[8]||(t[8]=s=>o.value.pageSize=s),total:b.value,onCurrentChange:f,onSizeChange:c},null,8,["current-page","page-size","total"])])])]),_:1}),e(p(te),{ref_key:"modalImportRef",ref:_,onConfirm:h},null,512)],64)}}});const Ze=D(Fe,[["__scopeId","data-v-93a7ddd6"]]);export{Ze as default};
